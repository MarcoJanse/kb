# Create and manage a blog using Jekyll hosted on GitHub Pages

## Index

- [Create and manage a blog using Jekyll hosted on GitHub Pages](#create-and-manage-a-blog-using-jekyll-hosted-on-github-pages)
  - [Index](#index)
  - [Introduction](#introduction)
  - [Prerequisites](#prerequisites)
  - [Steps](#steps)
    - [Create empty repository](#create-empty-repository)
      - [gitattributes file](#gitattributes-file)
      - [gitignore file](#gitignore-file)
    - [Create a Codespace](#create-a-codespace)
    - [Create and configure Jekyll static website using Codespaces](#create-and-configure-jekyll-static-website-using-codespaces)
    - [Customize site](#customize-site)
      - [\_config.yml](#_configyml)
      - [Additional subdirectories](#additional-subdirectories)
      - [about.markdown](#aboutmarkdown)
  - [Configure DNS and GitHub pages configuration](#configure-dns-and-github-pages-configuration)
    - [Prepare DNS](#prepare-dns)
    - [GitHub pages configuration](#github-pages-configuration)
  - [References](#references)

## Introduction

This document describes the steps required for hosting my blog on GitHub Pages using Jekyll. I will use GitHub Codespaces to manage my blog

## Prerequisites

- An empty (public) repository on your GitHub account named `<username>.github.io`. (in lowercase)
- Knowledge of Git, GitHub, VSCode and a little bit of Linux

## Steps

### Create empty repository

If not already done so, create an empty repository on GitHub using `<username>.github.io` as the name. Be sure to add a README.MD file during creation.

I always create a `.gitattributes` and `.gitignore` file, which I advise you to do as well.

#### gitattributes file

Below is the `.gitattributes` content

```bash
* text=auto eol=lf
```

This will make sure that git properly handles line endings, regardless of Operating system differences. More information can be found here: 

- [Configuring Git to handle line endings | GitHub Docs](https://docs.github.com/en/get-started/getting-started-with-git/configuring-git-to-handle-line-endings)

#### gitignore file

Below is the content of the `.gitignore` file:

```bash
# Secrets and Keys
*.key
*.cer
*.pem
*.pfx

# Backup files
*.bak

# Ignore folders generated by Bundler
.bundle/
vendor/

# Jekyll files
_site/
.sass-cache/
.jekyll-cache/
.jekyll-metadata

# Logs
*.log

# Temp files
*.tmp

# Vscode
.vscode/
```

This will make sure that certain folders and files will not be committed to your repository, like temp files and secrets. This is a precaution I always make when creating a new repository. There are loads of prebuild `.gitignore` files, depending on your need. More information can be found here:

- [gitignore file | Git docs](https://git-scm.com/docs/gitignore)
- [Ignoring files | GitHub Docs](https://docs.github.com/en/get-started/getting-started-with-git/ignoring-files)
- [A collection of .gitignore templates | GitHub](https://github.com/github/gitignore)

### Create a Codespace

- From within your repository on GitHub.
- Using the Code menu pick the Codespaces tab and select Create.
  - This will spin up a Codespaces container and open a new tab in your browser with a VSCode web ISE.
- Using the Codespaces button in the corner to get the command palette, select ***Add Dev Container Configuration Files***. Then selected ***New Configuration***.
- Chose to Show All definitions then search for and select Jekyll. I picked the default bullseye definition and didnâ€™t choose any additional options.
- I then rebuild the codespace using the Codespaces button in the lower left corner and selecting ***Rebuild Container***
- You can validate required components are installed using these commands:
  - `ruby -v`
  - `gcc -v`
  - `make -v`
  - `jekyll -v`

### Create and configure Jekyll static website using Codespaces

- From within your codespaces, make sure you are in the root of your folder (`workspaces/<username>.github.io`) on the main branch. (At this point, you shouldn't have any sub folders or additional branches yet)
- Create a docs folder to host your Jekyll site.
  - `mkdir docs`
- Initialize a new Jekyll project from the docs folder
  - `cd docs``
  - `jekyll new --skip-bundle`
- Open and edit the `Gemfile`
  - Comment the `gem "jekyll"` line
  - Uncomment the `gem github-pages` line and change it to include the latest gem version of GitHub pages, which can be found on this page: [Dependency versions | GitHub Pages](https://pages.github.com/versions/). At the time of writing, this was `228`
- Run `bundle update` to install your dependencies. This will create `Gemfile.lock`
- Add the webrick dependency manually, as this is no longer installed by default with Ruby 3.x
  - `bundle add webrick`
- Test your site locally by the following command:
  - `bundle exec jekyll serve --livereload`

> This should open a new tab with a preview of your site. It should be completely default now. You can use `[Ctrl] + c` to stop.

Below is the Gemfile configuration after the above steps

```bash
source "https://rubygems.org"
# Hello! This is where you manage which Jekyll version is used to run.
# When you want to use a different version, change it below, save the
# file and run `bundle install`. Run Jekyll with `bundle exec`, like so:
#
#     bundle exec jekyll serve
#
# This will help ensure the proper Jekyll version is running.
# Happy Jekylling!
# gem "jekyll", "~> 4.3.2"
# This is the default theme for new Jekyll sites. You may change this to anything you like.
gem "minima", "~> 2.5"
# If you want to use GitHub Pages, remove the "gem "jekyll"" above and
# uncomment the line below. To upgrade, run `bundle update github-pages`.
gem "github-pages", "~> 228", group: :jekyll_plugins
# If you have any plugins, put them here!
group :jekyll_plugins do
  gem "jekyll-feed", "~> 0.12"
end

# Windows and JRuby does not include zoneinfo files, so bundle the tzinfo-data gem
# and associated library.
platforms :mingw, :x64_mingw, :mswin, :jruby do
  gem "tzinfo", ">= 1", "< 3"
  gem "tzinfo-data"
end

# Performance-booster for watching directories on Windows
gem "wdm", "~> 0.1.1", :platforms => [:mingw, :x64_mingw, :mswin]

# Lock `http_parser.rb` gem to `v0.6.x` on JRuby builds since newer versions of the gem
# do not have a Java counterpart.
gem "http_parser.rb", "~> 0.6.0", :platforms => [:jruby]

gem "webrick", "~> 1.8"
```

> **NOTE** If the site works, do yourself a favour and commit these changes to main before making making any changes. This way, you will be able to easily revert to the original configuration and see any changes since then.

### Customize site

#### _config.yml

In the `_config.yml`, you can set some basic settings for the site, like the title and description of your site, contact details, but also things like the them to build your site with.

I've modified the following fields for now: (but I intend to change the theme later on)

- title: `ICTStuff.info`
- email: `marco.janse@ictstuff.info`
- description: `Scribbles from a IT Engineer trying to become a DevOps engineer and conquer his Imposter Syndrome`
- url: `"https://ictstuff.info"`
- twitter_username: `MarcoJanse`
- github_username: `MarcoJanse`
- Build settings
  - plugins:
    + jekyll-remote-theme
- Site settings
  - permalink: `/:collection/:year-:month-:day-:title:output_ext`

Below is the complete `_config.yml` file contents:

```yaml
# Welcome to Jekyll!
#
# This config file is meant for settings that affect your whole blog, values
# which you are expected to set up once and rarely edit after that. If you find
# yourself editing this file very often, consider using Jekyll's data files
# feature for the data you need to update frequently.
#
# For technical reasons, this file is *NOT* reloaded automatically when you use
# 'bundle exec jekyll serve'. If you change this file, please restart the server process.
#
# If you need help with YAML syntax, here are some quick references for you:
# https://learn-the-web.algonquindesign.ca/topics/markdown-yaml-cheat-sheet/#yaml
# https://learnxinyminutes.com/docs/yaml/
#
# Site settings
# These are used to personalize your new site. If you look in the HTML files,
# you will see them accessed via {{ site.title }}, {{ site.email }}, and so on.
# You can create any custom variable you would like, and they will be accessible
# in the templates via {{ site.myvariable }}.

title: ICTStuff.info
email: marco.janse@ictstuff.info
description: >- # this means to ignore newlines until "baseurl:"
  Scribbles from a IT Engineer trying to become a DevOps engineer and conquer his Imposter Syndrome
baseurl: "" # the subpath of your site, e.g. /blog
url: "https://ictstuff.info" # the base hostname & protocol for your site, e.g. http://example.com
twitter_username: MarcoJanse
github_username: MarcoJanse

# Build settings
theme: minima
plugins:
  - jekyll-feed
  - jekyll-remote-theme

# Site settings
permalink: /:collection/:year-:month-:day-:title:output_ext

# Exclude from processing.
# The following items will not be processed, by default.
# Any item listed under the `exclude:` key here will be automatically added to
# the internal "default list".
#
# Excluded items can be processed by explicitly listing the directories or
# their entries' file path in the `include:` list.
#
# exclude:
#   - .sass-cache/
#   - .jekyll-cache/
#   - gemfiles/
#   - Gemfile
#   - Gemfile.lock
#   - node_modules/
#   - vendor/bundle/
#   - vendor/cache/
#   - vendor/gems/
#   - vendor/ruby/
```

#### Additional subdirectories

Under the docs directory, I created the following subdirectories:

- `_drafts`
- `assets`
  - `images`

#### about.markdown

This file was updated with relevant content for an about page and I added a reference to an image, which I first uploaded to the `assets/images` by right-clicking the folder in the VSCode explorer and selecting `Upload..`

Below is the code block for adding the image and resizing this:

`![About Me](/assets/images/marco-simpsonized.png){:width="20%"}`

## Configure DNS and GitHub pages configuration

### Prepare DNS

Please refer to [Configure an apex domain](https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site#configuring-an-apex-domain) for the A-records and AAAA-records that need to be added to your domain using the registar's DNS control panel.

```bash
# A-records
185.199.108.153
185.199.109.153
185.199.110.153
185.199.111.153

# AAAA-records
2606:50c0:8000::153
2606:50c0:8001::153
2606:50c0:8002::153
2606:50c0:8003::153
```

### GitHub pages configuration

- Navigate to `username.github.io` repository and go to Settings
- From within Settings, select Pages
- Configure your site to deploy from a branch
  - Make sure `main` is selected as branch
  - Make sure `/docs` is selected as folder

## References

- [Setting up a GitHub Pages site with Jekyll | GitHub Docs](https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll)
- [Creating a GitHub Pages site with Jekyll | GitHub Docs](https://docs.github.com/en/pages/setting-up-a-github-pages-site-with-jekyll/creating-a-github-pages-site-with-jekyll)
- [Build A Portfolio With A Blog Using GitHub Pages | Simon Dosda blog](https://simondosda.github.io/posts/2021-09-13-blog-github-pages-1-introduction.html)
- [Using a GitHub Codespace for Jekyll site development | Matthew C Anderson Blog](https://www.matthewcanderson.com/codespace-for-jekyll/)
